/home/jrg4wx/anaconda3/envs/subpop_bench/lib/python3.9/site-packages/sklearn/utils/fixes.py:28: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
  from pkg_resources import parse_version  # type: ignore
Environment:
	Python: 3.9.7
	PyTorch: 2.8.0+cu128
	Torchvision: 0.23.0+cu128
	CUDA: 12.8
	CUDNN: 91002
	NumPy: 1.19.5
	PIL: 11.3.0
Args:
	algorithm: GroupDRO
	checkpoint_freq: None
	cmnist_attr_prob: 0.5
	cmnist_flip_prob: 0.25
	cmnist_label_prob: 0.5
	cmnist_spur_prob: 0.2
	data_dir: /scratch/jrg4wx/subpop_bench/data
	dataset: Waterbirds
	es_metric: min_group:accuracy
	es_patience: 5
	es_strategy: metric
	hparams: None
	hparams_seed: 13
	image_arch: resnet_sup_in1k
	output_dir: ./output/wb_all_methods_16hp_3seed_attrNo_20260117_151131_attrNo/Waterbirds_GroupDRO_hparams13_seed0
	output_folder_name: wb_all_methods_16hp_3seed_attrNo_20260117_151131_attrNo
	pretrained: 
	resume: 
	seed: 0
	skip_model_save: False
	stage1_algo: ERM
	stage1_folder: vanilla
	steps: None
	store_name: Waterbirds_GroupDRO_hparams13_seed0
	tb_log_all: False
	text_arch: bert-base-uncased
	train_attr: no
	use_es: False
HParams:
	batch_size: 100
	group_balanced: False
	groupdro_eta: 0.0011461888016596692
	image_arch: resnet_sup_in1k
	last_layer_dropout: 0.0
	lr: 0.0012489762100914873
	nonlinear_classifier: False
	optimizer: sgd
	pretrained: True
	resnet18: False
	text_arch: bert-base-uncased
	weight_decay: 0.00044104605484110844
Dataset:
	[train]	4795 (without attributes)
	[val]	1199
	[test]	5794
/home/jrg4wx/anaconda3/envs/subpop_bench/lib/python3.9/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/home/jrg4wx/anaconda3/envs/subpop_bench/lib/python3.9/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet50_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet50_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)


step          epoch         loss          te_avg_acc    te_worst_acc  va_avg_acc    va_worst_acc 
0             0.0000        0.6830        0.7154        0.3972        0.7114        0.3233       
300           6.2565        0.0635        0.8828        0.7321        0.8649        0.6692       
600           12.5130       0.0015        0.8856        0.7368        0.8774        0.6917       
900           18.7696       0.0001        0.8885        0.7227        0.8791        0.6692       
1200          25.0261       0.0001        0.8863        0.7243        0.8799        0.6917       
1500          31.2826       0.0000        0.8864        0.7196        0.8807        0.6917       
1800          37.5391       0.0000        0.8889        0.7103        0.8807        0.6692       
2100          43.7956       0.0000        0.8852        0.7196        0.8807        0.6917       
2400          50.0521       0.0000        0.8852        0.7196        0.8799        0.6917       
2700          56.3087       0.0000        0.8840        0.7196        0.8791        0.6917       
3000          62.5652       0.0000        0.8837        0.7150        0.8774        0.6992       
3300          68.8217       0.0000        0.8832        0.7150        0.8774        0.6992       
3600          75.0782       0.0000        0.8844        0.7134        0.8791        0.6992       
3900          81.3347       0.0000        0.8832        0.7150        0.8757        0.6917       
4200          87.5912       0.0000        0.8825        0.7150        0.8757        0.6842       
4500          93.8478       0.0000        0.8837        0.7118        0.8757        0.6842       
4800          100.1043      0.0000        0.8835        0.7150        0.8757        0.6842       
5000          104.2753      0.0000        0.8830        0.7118        0.8766        0.6917       

Test accuracy (best validation checkpoint):
	mean:	[0.883]
	worst:	[0.712]
Group-wise accuracy:
	[va] group-wise [0.996, 0.783, 0.692, 0.970]
	[te] group-wise [0.996, 0.800, 0.712, 0.947]
